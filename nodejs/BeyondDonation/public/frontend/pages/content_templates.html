<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Templates</title>

    <!-- Bootstrap Core CSS -->
    <link href="../vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- MetisMenu CSS -->
    <link href="../vendor/metisMenu/metisMenu.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="../dist/css/sb-admin-2.css" rel="stylesheet">

    <!-- Morris Charts CSS -->
    <link href="../vendor/morrisjs/morris.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="../vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <link href="http://cdn.datatables.net/1.10.12/css/jquery.dataTables.min.css" rel = "stylesheet" />

</head>

<body>

    <div id="wrapper">
        <nav class="navbar navbar-default navbar-static-top" role="navigation" style="margin-bottom: 0" id = "navbar">

        </nav>

        <div id="page-wrapper">
            <div class="row">
                <div class="col-lg-12">
                    <h1 class="page-header">Templates</h1>
                </div>
                <!-- /.col-lg-12 -->
            </div>
            <div class="row">
              <div class="col-lg-12 ">
                  <button class="btn btn-primary pull-right" data-toggle="modal" onclick="addRow()">
                    <b>Add New Templates</b>
                  </button>
              </div>
            </div>

            <div class="row">
              <div class="col-lg-12">
                <div class="panel panel-default">
                  <div class="panel-heading"> List of Templates </div>
                    <div class="panel-body">
                      <table width="100%" class="table table-striped table-bordered table-hover" id="child-table">
                        <thead>
                          <tr>
                            <th>Sno</th>
                            <th>Name</th>
                            <th>Subject</th>
                            <th>Body</th>
                            <th>Buttons</th>
                          </tr>
                        </thead>
                        <tbody id = "tbody">
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
            </div>
          </div>
        </div>

        <div class="modal fade" id="edit-modal" tabindex="-1" role="dialog" aria-labelledby="edit-modal-label">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <form class="form-horizontal" id="edit-form">
                <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                  <h4 class="modal-title" id="edit-modal-label">Edit Template Details</h4>
                </div>
                <div class="modal-body">
                  <input type="hidden" id="edit-id" value="" class="hidden">
                  <div class="form-group">
                    <label for="name" class="col-sm-2 control-label">Name</label>
                    <div class="col-sm-10">
                      <input type="text" class="form-control" id="name"
                        name="name" placeholder="Template Name" required>
                    </div>
                  </div>
                  <div class="form-group">
                    <label for="subject" class="col-sm-2 control-label">Subject</label>
                    <div class="col-sm-10">
                      <input type="text" class="form-control" id="subject"
                        name="subject" placeholder="Template Subject" required>
                    </div>
                  </div>
                  <div class="form-group">
                    <label for="description" class="col-sm-2 control-label">Description</label>
                    <div class="col-sm-10">
                      <textarea class="form-control" id="description"
                        name="description" placeholder="Decription" required></textarea>
                    </div>
                  </div>
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-default"
                    data-dismiss="modal">Close</button>
                  <button type="submit" class="btn btn-primary">Save Changes</button>
                </div>
              </form>
            </div>
          </div>
        </div>

        <div class="modal fade" id="add-modal" tabindex="-1" role="dialog"
          aria-labelledby="add-modal-label">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <form class="form-horizontal" id="add-form">
                <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal"
                    aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                  <h4 class="modal-title" id="add-modal-label">Add New Template</h4>
                </div>
                <div class="modal-body">
                  <div class="form-group">
                    <label for="add-name" class="col-sm-2 control-label">Name</label>
                    <div class="col-sm-10">
                      <input type="text" class="form-control" id="add-name"
                        name="name" placeholder="Template Name" required>
                    </div>
                  </div>
                  <div class="form-group">
                    <label for="add-subject" class="col-sm-2 control-label">Subject</label>
                    <div class="col-sm-10">
                      <input type="text" class="form-control" id="add-subject"
                        name="add-subject" placeholder="Template Subject" required>
                    </div>
                  </div>
                  <div class="form-group">
                    <label for="add-description" class="col-sm-2 control-label">Description</label>
                    <div class="col-sm-10">
                      <textarea type="text" class="form-control" id="add-description"
                        name="description" placeholder="Decription" required></textarea>
                    </div>
                  </div>
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-default"
                    data-dismiss="modal">Close</button>
                  <button type="submit" class="btn btn-primary">Add Template</button>
                </div>
              </form>
            </div>
          </div>
        </div>

    <!-- jQuery -->
    <script src="../vendor/jquery/jquery.min.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="../vendor/bootstrap/js/bootstrap.min.js"></script>

    <!-- Metis Menu Plugin JavaScript -->
    <script src="../vendor/metisMenu/metisMenu.min.js"></script>

    <script src="../dist/js/sb-admin-2.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.js"></script>

    <script src = "http://cdn.datatables.net/1.10.12/js/jquery.dataTables.min.js"></script>

    <script type="text/javascript" language="javascript" class="init">

      $(document).ready(function() {

          loadTable();

          $("#navbar").load("navbar.html");

          $(function() {
            if (!Modernizr.inputtypes.date) {
              $('input[type=date]').datepicker({
                dateFormat : 'yy-mm-dd'
              });
            }
          });

          $("#edit-form").on("submit", function(event) {
              event.preventDefault();

              var name = $("#name").val();
              var subject = $("#subject").val();
              var description = $("#description").val();

              $("#edit-modal").modal('hide');
              editChild(name, subject, description);
          });

          $("#add-form").on("submit", function(event) {
              event.preventDefault();

              var name = $("#add-name").val();
              var subject = $("#add-subject").val();
              var description = $("#add-description").val();

              $("#add-modal").modal('hide');
              addChild(name, subject, description);

            });


      });

      function addRow() {
        $("#add-modal").modal('show');
      }

      // Edit row
      function editRow(id) {

        var tds = document.getElementById(id).children;
        var old_name = tds[1].innerHTML;
        var old_subject = tds[2].innerHTML;
        var old_description = tds[3].innerHTML

        console.log(old_name + " " + old_subject + " " + old_description);

        $("#edit-modal").modal('show');

        $("#name").val(old_name);
        $("#subject").val(old_subject);
        $("#description").val(old_description);

        //TODO Check what to do with this data
      }

      function removeRow(id) {

        var tds = document.getElementById(id).children;
        var name = tds[1].innerHTML;
        var subject = tds[2].innerHTML;
        var description = tds[3].innerHTML

        console.log(name);

        var decision = confirm("Do you want to delete?");
        if (decision == true) {
          removeChild(name, subject, description);
        }
      }

      function loadTable() {
        console.log("in load table");
        $('#tbody').html("");
        //TODO Make Ajax Call
        for(var i = 1; i < 11; i++) {
        $('#tbody').append(
            '<tr role="row" id = "' +  i+ '""><td class="sorting_1">' + i
                + '</td><td>' + "Vivek" + i + '</td><td>'
                + '2016-11-11'+ '</td><td>'
                + "Hi Vivek" + '</td><td><a data-id="row-' + i
                + '" href="javascript:editRow(' + i
                + ');" class="btn btn-warning btn-sm btn-block">Edit</a><a href="javascript:removeRow(' + i + ');" class="btn btn-danger btn-sm btn-block">Delete</a></td></tr>');
          }

          $('#child-table').DataTable({
              responsive: true
          });
        }

      function editChild(name, subject, description) {
        //TODO Make AJAX Call
        console.log(name + " " + subject  + " " + description);
        $("#edit-modal").modal('hide');
      }

      function addChild(name, subject, description) {
        //TODO Make AJAX Call
        console.log(name + " " + subject  + " " + description);

        $("#add-modal").modal('hide');
      }

      function removeChild(name, subject, description) {
        console.log(name + " " + subject  + description);

        //TODO Make AJAX Call
      }

    </script>

</body>

</html>
